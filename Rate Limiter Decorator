import time
import threading
from collections import deque
from functools import wraps

class RateLimitExceeded(Exception):
    pass

def rate_limiter(max_calls):
    calls = deque()
    lock = threading.Lock()

    def decorator(func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            now = time.time()

            with lock:
                while calls and now - calls[0] > 60:
                    calls.popleft()

                if len(calls) >= max_calls:
                    raise RateLimitExceeded("Rate limit exceeded")

                calls.append(now)

            return func(*args, **kwargs)
        return wrapper
    return decorator
